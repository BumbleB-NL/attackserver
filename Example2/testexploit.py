#!/usr/bin/env python3
import sys
import requests

def fetch_json_and_output_flag(host):
    try:
        # Fetch the JSON data from the URL
        url = "http://" + host + "/index.json"
        print("Url = {}".format(url))
        response = requests.get(url)
        response.raise_for_status()  # Raise an error for bad responses (4xx or 5xx)
        data = response.json()

        # Check if the 'flag' key exists in the JSON
        if 'flag' in data:
            print(data['flag'], flush=True)
        else:
            print("Flag not found in the JSON.")

    except requests.exceptions.RequestException as e:
        print(f"Error fetching data from {url}: {str(e)}")
    except ValueError:
        print("Error: Invalid JSON response.")
    except Exception as e:
        print(f"An error occurred: {str(e)}")



if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python script.py <host>")
    else:
        host = sys.argv[1]
        print("Host = {}".format(host))
        fetch_json_and_output_flag(host)
